{
  "hash": "ed83e8019295c1b1d61c3311e43a810d",
  "result": {
    "engine": "knitr",
    "markdown": "---\nengine: knitr\ntitle: Trade-offs\n---\n\n## Learning objectives:\n\n- Decide whether to use S3 or S4 (or maybe S7) for a project.\n- Decide whether to use R6 or S3 (or maybe S7) for a project.\n\n## Default to S3`*`\n\n> \"I recommend that you default to S3.\" - Hadley Wickham\n\n- Simple & widely used\n- R6 leads to non-idiomatic R code\n  - More like other languages, so tempting for newcomers\n\n`*` [Or maybe S7?](https://bsky.app/profile/did:plc:peeplnvlwcohp4jly3fpwj46/post/3m73gizpiw22n)\n\n::: notes\n- \"Functional OOP\" aka \"Generic function OOP\" aka \"Multimethod OOP\"\n  - S3, S4, S7\n- \"Encapsulated OOP\"\n  - R6\n:::\n\n## Use S4 for large team projects`*`\n\n- S4 requires more up-front design than S3\n- S4 is more formal, strict, and verbose\n- Structure from S4 reduces risk from new team members\n- Examples:\n  - [Bioconductor](https://www.bioconductor.org/) (~3-4k packages)\n  - [{Matrix}](https://cran.r-project.org/package=Matrix) (108 classes, 23 generic functions, and 1780 methods)\n- S4 lacks great docs (needs a book)\n\n`*` Maybe use S7 instead?\n\n## Use S3 for standard, shared methods\n\n- S3 generics are global functions\n  - Standard generics: `print()`, `summary()`, `plot()`, `predict()`, etc.\n  - Easy to create your own class & methods\n- R6 methods are local to the object\n  - Can have different args than standard method\n  - Can mean something else entirely vs standard\n- R6 objects are S3 objects, too!\n  - Can define S3 methods for R6 classes\n\n## Use R6 for stateful objects\n\n- R6 methods can modify object state\n  - No need to thread state through functions\n- Chain R6 methods with `$`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Stack is an `R6::R6Class()` with `push()`, `pop()`, and `length()` methods\ns <- Stack$new()\ns$\n  push(10)$\n  push(20)$\n  pop()\n#> [1] 20\n```\n:::\n\n\n## OOP system comparison\n\n::: {style=\"font-size: 0.5em;\"}\n| | S3 | S4 | S7 | R6 |\n|-------|------|------|------|------|\n| *Package* | base R | base R | [S7](https://rconsortium.github.io/S7/) | [R6](https://r6.r-lib.org/) |\n| *OOP type* | Functional | Functional | Functional | Encapulated |\n| *Complexity* | Low | High | Medium | High |\n| *Payoff* | Low | High | High | High |\n| *Team size* | Small | Large | Large | Small-large |\n| *Namespace* | Global | Global | Global | Local |\n| *Modify in place* | No | No | No | Yes |\n| *Method chaining* | `|>` | `|>` | `|>` | `$` |\n| *Get/set* | `$` | `@` | `@` | `$` |\n| *Create class* | `function()` | `setClass()` | `new_class()` | `R6Class()` |\n| *Create validator* | `function()` | `setValidity() | setClass(validator = f())` | `new_class(validator = f())` | `$validate()` |\n| *Create generic* | `UseMethod()` | `setGeneric()` | `new_generic()` | `NA` |\n| *Create method* | `g.y <- function()` | `setMethod()` | `method()` | `R6Class()` |\n| *Create object* | `class(x) <- \"y\"` | `new()` | `x <- class_y()` | `$new()` |\n| *Additional components* | attributes | slots | properties | fields & methods |\n| | | | | |\n:::",
    "supporting": [
      "16_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}